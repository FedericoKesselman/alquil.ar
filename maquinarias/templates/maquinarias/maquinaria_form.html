{% extends 'base.html' %} 
{% block content %}
<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h3 class="mb-0">{{ action }} Maquinaria</h3>
    </div>
    <div class="card-body">
      {% if messages %}
      <div class="messages mb-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- AGREGADO: Mostrar errores generales del formulario -->
      {% if form.non_field_errors %}
      <div class="alert alert-danger mb-3">
        {% for error in form.non_field_errors %}
          <div>{{ error }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row">
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label>{{ form.nombre.label }}</label>
              {{ form.nombre }} 
              {% if form.nombre.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.nombre.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.tipo.label }}</label>
              {{ form.tipo }} 
              {% if form.tipo.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.tipo.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.marca.label }}</label>
              {{ form.marca }} 
              {% if form.marca.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.marca.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.modelo.label }}</label>
              {{ form.modelo }} 
              {% if form.modelo.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.modelo.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.anio.label }}</label>
              {{ form.anio }} 
              {% if form.anio.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.anio.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group mb-3">
              <label>{{ form.precio_por_dia.label }}</label>
              {{ form.precio_por_dia }} 
              {% if form.precio_por_dia.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.precio_por_dia.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.stock_total.label }}</label>
              {{ form.stock_total }} 
              {% if form.stock_total.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.stock_total.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.minimo.label }}</label>
              {{ form.minimo }} 
              {% if form.minimo.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.minimo.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.maximo.label }}</label>
              {{ form.maximo }} 
              {% if form.maximo.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.maximo.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group mb-3">
              <label>{{ form.imagen.label }}</label>
              {{ form.imagen }} 
              {% if form.imagen.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.imagen.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="col-12">
            <div class="form-group mb-3">
              <label>{{ form.descripcion.label }}</label>
              {{ form.descripcion }} 
              {% if form.descripcion.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.descripcion.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group mb-3">
              <label>{{ form.cantDias_total.label }}</label>
              {{ form.cantDias_total }} 
              {% if form.cantDias_total.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.cantDias_total.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group mb-3">
              <label>{{ form.cantDias_parcial.label }}</label>
              {{ form.cantDias_parcial }} 
              {% if form.cantDias_parcial.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.cantDias_parcial.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="col-md-4">
            <div class="form-group mb-3">
              <label>{{ form.cantDias_nulo.label }}</label>
              {{ form.cantDias_nulo }} 
              {% if form.cantDias_nulo.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.cantDias_nulo.errors %}
                  <div>{{ error }}</div>
                {% endfor %}
              </div>
              {% endif %}
            </div>
          </div>
        </div>

        <div class="mt-4">
          <a href="{% url 'maquinaria_list' %}" class="btn btn-secondary">Volver</a>
          <button type="submit" class="btn btn-primary float-end">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>


{% endblock %}